<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>descriptor &mdash; Materials Learning Algorithms (MALA)  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/mala_favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="lammps_utils" href="mala.descriptors.lammps_utils.html" />
    <link rel="prev" title="bispectrum" href="mala.descriptors.bispectrum.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/mala_horizontal_white.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="mala.html">mala</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="mala.common.html">common</a></li>
<li class="toctree-l3"><a class="reference internal" href="mala.datageneration.html">datageneration</a></li>
<li class="toctree-l3"><a class="reference internal" href="mala.datahandling.html">datahandling</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="mala.descriptors.html">descriptors</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="mala.descriptors.atomic_density.html">atomic_density</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.descriptors.bispectrum.html">bispectrum</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">descriptor</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.descriptors.lammps_utils.html">lammps_utils</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mala.interfaces.html">interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="mala.network.html">network</a></li>
<li class="toctree-l3"><a class="reference internal" href="mala.targets.html">targets</a></li>
<li class="toctree-l3"><a class="reference internal" href="mala.version.html">version</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTE.html">Contributing to MALA</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Materials Learning Algorithms (MALA)</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html">API reference</a> &raquo;</li>
          <li><a href="mala.html">mala</a> &raquo;</li>
          <li><a href="mala.descriptors.html">descriptors</a> &raquo;</li>
      <li>descriptor</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com//mala-project/mala/blob/develop/docs/source/api/mala.descriptors.descriptor.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-mala.descriptors.descriptor">
<span id="descriptor"></span><h1>descriptor<a class="headerlink" href="#module-mala.descriptors.descriptor" title="Permalink to this headline"></a></h1>
<p>Base class for all descriptor calculators.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mala.descriptors.descriptor.Descriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Descriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mala.common.parameters.html#mala.common.parameters.Parameters" title="mala.common.parameters.Parameters"><span class="pre">mala.common.parameters.Parameters</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/descriptors/descriptor.html#Descriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.descriptors.descriptor.Descriptor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class for all descriptors available in MALA.</p>
<p>Descriptors encode the atomic fingerprint of a DFT calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parameters</strong> (<a class="reference internal" href="mala.common.parameters.html#mala.common.parameters.Parameters" title="mala.common.parameters.Parameters"><em>mala.common.parameters.Parameters</em></a>) – Parameters object used to create this object.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mala.descriptors.descriptor.Descriptor.backconvert_units">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backconvert_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_units</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/descriptors/descriptor.html#Descriptor.backconvert_units"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.descriptors.descriptor.Descriptor.backconvert_units" title="Permalink to this definition"></a></dt>
<dd><p>Convert descriptors from MALA units into a specified unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>numpy.array</em>) – Data in MALA units.</p></li>
<li><p><strong>out_units</strong> (<em>string</em>) – Desired units of output array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>converted_array</strong> – Data in out_units.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mala.descriptors.descriptor.Descriptor.calculate_from_atoms">
<span class="sig-name descname"><span class="pre">calculate_from_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">working_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/descriptors/descriptor.html#Descriptor.calculate_from_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.descriptors.descriptor.Descriptor.calculate_from_atoms" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the bispectrum descriptors based on atomic configurations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>ase.Atoms</em>) – Atoms object holding the atomic configuration.</p></li>
<li><p><strong>grid_dimensions</strong> (<em>list</em>) – Grid dimensions to be used, in the format [x,y,z].</p></li>
<li><p><strong>working_directory</strong> (<em>string</em>) – A directory in which to write the output of the LAMMPS calculation.
Usually the local directory should suffice, given that there
are no multiple instances running in the same directory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>descriptors</strong> – Numpy array containing the descriptors with the dimension
(x,y,z,descriptor_dimension)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mala.descriptors.descriptor.Descriptor.calculate_from_qe_out">
<span class="sig-name descname"><span class="pre">calculate_from_qe_out</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qe_out_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">working_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/descriptors/descriptor.html#Descriptor.calculate_from_qe_out"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.descriptors.descriptor.Descriptor.calculate_from_qe_out" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the descriptors based on a Quantum Espresso outfile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qe_out_file</strong> (<em>string</em>) – Name of Quantum Espresso output file for snapshot.</p></li>
<li><p><strong>working_directory</strong> (<em>string</em>) – A directory in which to write the output of the LAMMPS calculation.
Usually the local directory should suffice, given that there
are no multiple instances running in the same directory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>descriptors</strong> – Numpy array containing the descriptors with the dimension
(x,y,z,descriptor_dimension)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mala.descriptors.descriptor.Descriptor.convert_units">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">convert_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1/eV'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/descriptors/descriptor.html#Descriptor.convert_units"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.descriptors.descriptor.Descriptor.convert_units" title="Permalink to this definition"></a></dt>
<dd><p>Convert descriptors from a specified unit into the ones used in MALA.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>numpy.array</em>) – Data for which the units should be converted.</p></li>
<li><p><strong>in_units</strong> (<em>string</em>) – Units of array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>converted_array</strong> – Data in MALA units.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mala.descriptors.descriptor.Descriptor.enforce_pbc">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">enforce_pbc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/descriptors/descriptor.html#Descriptor.enforce_pbc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.descriptors.descriptor.Descriptor.enforce_pbc" title="Permalink to this definition"></a></dt>
<dd><p>Explictly enforces the PBC on an ASE atoms object.</p>
<p>QE (and potentially other codes?) do that internally. Meaning that the
raw positions of atoms (in Angstrom) can lie outside of the unit cell.
When setting up the DFT calculation, these atoms get shifted into
the unit cell. Since we directly use these raw positions for the
descriptor calculation, we need to enforce that in the ASE atoms
objects, the atoms are explicitly in the unit cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atoms</strong> (<em>ase.atoms</em>) – The ASE atoms object for which the PBC need to be enforced.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new_atoms</strong> – The ASE atoms object for which the PBC have been enforced.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ase.Atoms</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mala.descriptors.descriptor.Descriptor.gather_descriptors">
<span class="sig-name descname"><span class="pre">gather_descriptors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snap_descriptors_np</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_pickled_comm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/descriptors/descriptor.html#Descriptor.gather_descriptors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.descriptors.descriptor.Descriptor.gather_descriptors" title="Permalink to this definition"></a></dt>
<dd><p>Gathers all bispectrum descriptors on rank 0 and sorts them.</p>
<p>This is useful for e.g. parallel preprocessing.
This function removes the extra 3 components that come from parallel
processing.
I.e. if we have 91 bispectrum descriptors, LAMMPS directly outputs us
97 (in parallel mode), and this function returns 94, as to retain the
3 x,y,z ones we by default include.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snap_descriptors_np</strong> (<em>numpy.array</em>) – Numpy array with the descriptors of this ranks local grid.</p></li>
<li><p><strong>use_pickled_comm</strong> (<em>bool</em>) – If True, the pickled communication route from mpi4py is used.
If False, a Recv/Sendv combination is used. I am not entirely
sure what is faster. Technically Recv/Sendv should be faster,
but I doubt my implementation is all that optimal. For the pickled
route we can use gather(), which should be fairly quick.
However, for large grids, one CANNOT use the pickled route;
too large python objects will break it. Therefore, I am setting
the Recv/Sendv route as default.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mala.descriptors.descriptor.Descriptor.get_acsd">
<span class="sig-name descname"><span class="pre">get_acsd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">descriptor_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ldos_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/descriptors/descriptor.html#Descriptor.get_acsd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.descriptors.descriptor.Descriptor.get_acsd" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the ACSD for given descriptors and LDOS data.</p>
<p>ACSD stands for average cosine similarity distance and is a metric
of how well the descriptors capture the local environment to a
degree where similar vectors result in simlar LDOS vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>descriptor_data</strong> (<em>numpy.ndarray</em>) – Array containing the descriptors.</p></li>
<li><p><strong>ldos_data</strong> (<em>numpy.ndarray</em>) – Array containing the LDOS.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>acsd</strong> – The average cosine similarity distance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mala.descriptors.descriptor.Descriptor.descriptors_contain_xyz">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">descriptors_contain_xyz</span></span><a class="headerlink" href="#mala.descriptors.descriptor.Descriptor.descriptors_contain_xyz" title="Permalink to this definition"></a></dt>
<dd><p>Control whether descriptor vectors will contain xyz coordinates.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mala.descriptors.bispectrum.html" class="btn btn-neutral float-left" title="bispectrum" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mala.descriptors.lammps_utils.html" class="btn btn-neutral float-right" title="lammps_utils" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021 National Technology &amp; Engineering Solutions of Sandia, LLC (NTESS). Under the terms of Contract DE-NA0003525 with NTESS, the U.S. Government retains certain rights in this software. Attila Cangi, J. Austin Ellis, Lenz Fiedler, Daniel Kotik, Normand Modine, Sivasankaran Rajamanickam, Steve Schmerler, Aidan Thompson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>