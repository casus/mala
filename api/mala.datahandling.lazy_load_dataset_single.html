<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>lazy_load_dataset_single &mdash; Materials Learning Algorithms (MALA)  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/mala_favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="multi_lazy_load_data_loader" href="mala.datahandling.multi_lazy_load_data_loader.html" />
    <link rel="prev" title="lazy_load_dataset" href="mala.datahandling.lazy_load_dataset.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/mala_horizontal_white.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="mala.html">mala</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="mala.common.html">common</a></li>
<li class="toctree-l3"><a class="reference internal" href="mala.datageneration.html">datageneration</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="mala.datahandling.html">datahandling</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="mala.datahandling.data_converter.html">data_converter</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.datahandling.data_handler.html">data_handler</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.datahandling.data_handler_base.html">data_handler_base</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.datahandling.data_repo.html">data_repo</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.datahandling.data_scaler.html">data_scaler</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.datahandling.data_shuffler.html">data_shuffler</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.datahandling.fast_tensor_dataset.html">fast_tensor_dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.datahandling.lazy_load_dataset.html">lazy_load_dataset</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">lazy_load_dataset_single</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.datahandling.multi_lazy_load_data_loader.html">multi_lazy_load_data_loader</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.datahandling.snapshot.html">snapshot</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mala.descriptors.html">descriptors</a></li>
<li class="toctree-l3"><a class="reference internal" href="mala.interfaces.html">interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="mala.network.html">network</a></li>
<li class="toctree-l3"><a class="reference internal" href="mala.targets.html">targets</a></li>
<li class="toctree-l3"><a class="reference internal" href="mala.version.html">version</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTE.html">Contributing to MALA</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Materials Learning Algorithms (MALA)</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html">API reference</a> &raquo;</li>
          <li><a href="mala.html">mala</a> &raquo;</li>
          <li><a href="mala.datahandling.html">datahandling</a> &raquo;</li>
      <li>lazy_load_dataset_single</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com//mala-project/mala/blob/develop/docs/source/api/mala.datahandling.lazy_load_dataset_single.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-mala.datahandling.lazy_load_dataset_single">
<span id="lazy-load-dataset-single"></span><h1>lazy_load_dataset_single<a class="headerlink" href="#module-mala.datahandling.lazy_load_dataset_single" title="Permalink to this headline"></a></h1>
<p>DataSet for lazy-loading.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mala.datahandling.lazy_load_dataset_single.LazyLoadDatasetSingle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LazyLoadDatasetSingle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/datahandling/lazy_load_dataset_single.html#LazyLoadDatasetSingle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.datahandling.lazy_load_dataset_single.LazyLoadDatasetSingle" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.data.Dataset</span></code></p>
<p>DataSet class for lazy loading.</p>
<p>Only loads snapshots in the memory that are currently being processed.
Uses a “caching” approach of keeping the last used snapshot in memory,
until values from a new ones are used. Therefore, shuffling at DataSampler
/ DataLoader level is discouraged to the point that it was disabled.
Instead, we mix the snapshot load order here ot have some sort of mixing
at all.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dimension</strong> (<em>int</em>) – Dimension of an input vector.</p></li>
<li><p><strong>output_dimension</strong> (<em>int</em>) – Dimension of an output vector.</p></li>
<li><p><strong>input_data_scaler</strong> (<a class="reference internal" href="mala.datahandling.data_scaler.html#mala.datahandling.data_scaler.DataScaler" title="mala.datahandling.data_scaler.DataScaler"><em>mala.datahandling.data_scaler.DataScaler</em></a>) – Used to scale the input data.</p></li>
<li><p><strong>output_data_scaler</strong> (<a class="reference internal" href="mala.datahandling.data_scaler.html#mala.datahandling.data_scaler.DataScaler" title="mala.datahandling.data_scaler.DataScaler"><em>mala.datahandling.data_scaler.DataScaler</em></a>) – Used to scale the output data.</p></li>
<li><p><strong>descriptor_calculator</strong> (<a class="reference internal" href="mala.descriptors.descriptor.html#mala.descriptors.descriptor.Descriptor" title="mala.descriptors.descriptor.Descriptor"><em>mala.descriptors.descriptor.Descriptor</em></a>) – Used to do unit conversion on input data.</p></li>
<li><p><strong>target_calculator</strong> (<a class="reference internal" href="mala.targets.target.html#mala.targets.target.Target" title="mala.targets.target.Target"><em>mala.targets.target.Target</em></a><em> or </em><em>derivative</em>) – Used to do unit conversion on output data.</p></li>
<li><p><strong>use_horovod</strong> (<em>bool</em>) – If true, it is assumed that horovod is used.</p></li>
<li><p><strong>input_requires_grad</strong> (<em>bool</em>) – If True, then the gradient is stored for the inputs.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mala.datahandling.lazy_load_dataset_single.LazyLoadDatasetSingle.allocate_shared_mem">
<span class="sig-name descname"><span class="pre">allocate_shared_mem</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/datahandling/lazy_load_dataset_single.html#LazyLoadDatasetSingle.allocate_shared_mem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.datahandling.lazy_load_dataset_single.LazyLoadDatasetSingle.allocate_shared_mem" title="Permalink to this definition"></a></dt>
<dd><p>Allocate the shared memory buffer for use by prefetching process.</p>
<p>Buffer is sized via numpy metadata.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mala.datahandling.lazy_load_dataset_single.LazyLoadDatasetSingle.deallocate_shared_mem">
<span class="sig-name descname"><span class="pre">deallocate_shared_mem</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/datahandling/lazy_load_dataset_single.html#LazyLoadDatasetSingle.deallocate_shared_mem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.datahandling.lazy_load_dataset_single.LazyLoadDatasetSingle.deallocate_shared_mem" title="Permalink to this definition"></a></dt>
<dd><p>Deallocate the shared memory buffer used by prefetching process.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mala.datahandling.lazy_load_dataset_single.LazyLoadDatasetSingle.delete_data">
<span class="sig-name descname"><span class="pre">delete_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/datahandling/lazy_load_dataset_single.html#LazyLoadDatasetSingle.delete_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.datahandling.lazy_load_dataset_single.LazyLoadDatasetSingle.delete_data" title="Permalink to this definition"></a></dt>
<dd><p>Free the shared memory buffers.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mala.datahandling.lazy_load_dataset_single.LazyLoadDatasetSingle.mix_datasets">
<span class="sig-name descname"><span class="pre">mix_datasets</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/datahandling/lazy_load_dataset_single.html#LazyLoadDatasetSingle.mix_datasets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.datahandling.lazy_load_dataset_single.LazyLoadDatasetSingle.mix_datasets" title="Permalink to this definition"></a></dt>
<dd><p>Shuffle the data in this data set.</p>
<p>For this class, instead of mixing the datasets, we just shuffle the
indices and leave the dataset order unchanged.
NOTE: It seems that the shuffled access to the shared memory
performance is much reduced (relative to the FastTensorDataset).
To regain performance, can rewrite to shuffle the datasets like in
the existing LazyLoadDataset. Another option might be
to try loading the numpy file in permuted order to avoid the shuffled
reads; however, this might require some care to
avoid erroneously overwriting shared memory data in cases where a
single dataset object is used back to back.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mala.datahandling.lazy_load_dataset.html" class="btn btn-neutral float-left" title="lazy_load_dataset" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mala.datahandling.multi_lazy_load_data_loader.html" class="btn btn-neutral float-right" title="multi_lazy_load_data_loader" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021 National Technology &amp; Engineering Solutions of Sandia, LLC (NTESS). Under the terms of Contract DE-NA0003525 with NTESS, the U.S. Government retains certain rights in this software. Attila Cangi, J. Austin Ellis, Lenz Fiedler, Daniel Kotik, Normand Modine, Sivasankaran Rajamanickam, Steve Schmerler, Aidan Thompson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>