<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>hyper_opt_optuna &mdash; Materials Learning Algorithms (MALA)  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/mala_favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="hyperparameter" href="mala.network.hyperparameter.html" />
    <link rel="prev" title="hyper_opt_oat" href="mala.network.hyper_opt_oat.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/mala_horizontal_white.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="mala.html">mala</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="mala.common.html">common</a></li>
<li class="toctree-l3"><a class="reference internal" href="mala.datageneration.html">datageneration</a></li>
<li class="toctree-l3"><a class="reference internal" href="mala.datahandling.html">datahandling</a></li>
<li class="toctree-l3"><a class="reference internal" href="mala.descriptors.html">descriptors</a></li>
<li class="toctree-l3"><a class="reference internal" href="mala.interfaces.html">interfaces</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="mala.network.html">network</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="mala.network.acsd_analyzer.html">acsd_analyzer</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.network.hyper_opt.html">hyper_opt</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.network.hyper_opt_naswot.html">hyper_opt_naswot</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.network.hyper_opt_oat.html">hyper_opt_oat</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">hyper_opt_optuna</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.network.hyperparameter.html">hyperparameter</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.network.hyperparameter_acsd.html">hyperparameter_acsd</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.network.hyperparameter_naswot.html">hyperparameter_naswot</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.network.hyperparameter_oat.html">hyperparameter_oat</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.network.hyperparameter_optuna.html">hyperparameter_optuna</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.network.multi_training_pruner.html">multi_training_pruner</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.network.naswot_pruner.html">naswot_pruner</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.network.network.html">network</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.network.objective_base.html">objective_base</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.network.objective_naswot.html">objective_naswot</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.network.predictor.html">predictor</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.network.runner.html">runner</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.network.tester.html">tester</a></li>
<li class="toctree-l4"><a class="reference internal" href="mala.network.trainer.html">trainer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mala.targets.html">targets</a></li>
<li class="toctree-l3"><a class="reference internal" href="mala.version.html">version</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTE.html">Contributing to MALA</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Materials Learning Algorithms (MALA)</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html">API reference</a> &raquo;</li>
          <li><a href="mala.html">mala</a> &raquo;</li>
          <li><a href="mala.network.html">network</a> &raquo;</li>
      <li>hyper_opt_optuna</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com//mala-project/mala/blob/develop/docs/source/api/mala.network.hyper_opt_optuna.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-mala.network.hyper_opt_optuna">
<span id="hyper-opt-optuna"></span><h1>hyper_opt_optuna<a class="headerlink" href="#module-mala.network.hyper_opt_optuna" title="Permalink to this headline"></a></h1>
<p>Hyperparameter optimizer using optuna.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mala.network.hyper_opt_optuna.HyperOptOptuna">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HyperOptOptuna</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mala.common.parameters.html#mala.common.parameters.Parameters" title="mala.common.parameters.Parameters"><span class="pre">mala.common.parameters.Parameters</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_pkl_checkpoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/network/hyper_opt_optuna.html#HyperOptOptuna"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.network.hyper_opt_optuna.HyperOptOptuna" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="mala.network.hyper_opt.html#mala.network.hyper_opt.HyperOpt" title="mala.network.hyper_opt.HyperOpt"><code class="xref py py-class docutils literal notranslate"><span class="pre">mala.network.hyper_opt.HyperOpt</span></code></a></p>
<p>Hyperparameter optimizer using Optuna.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="mala.common.parameters.html#mala.common.parameters.Parameters" title="mala.common.parameters.Parameters"><em>mala.common.parameters.Parameters</em></a>) – Parameters used to create this hyperparameter optimizer.</p></li>
<li><p><strong>data</strong> (<a class="reference internal" href="mala.datahandling.data_handler.html#mala.datahandling.data_handler.DataHandler" title="mala.datahandling.data_handler.DataHandler"><em>mala.datahandling.data_handler.DataHandler</em></a>) – DataHandler holding the data for the hyperparameter optimization.</p></li>
<li><p><strong>use_pkl_checkpoints</strong> (<em>bool</em>) – If true, .pkl checkpoints will be created.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mala.network.hyper_opt_optuna.HyperOptOptuna.get_trials_from_study">
<span class="sig-name descname"><span class="pre">get_trials_from_study</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/network/hyper_opt_optuna.html#HyperOptOptuna.get_trials_from_study"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.network.hyper_opt_optuna.HyperOptOptuna.get_trials_from_study" title="Permalink to this definition"></a></dt>
<dd><p>Return the trials from the last study.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>last_trials</strong> – A list of optuna.FrozenTrial objects.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mala.network.hyper_opt_optuna.HyperOptOptuna.load_from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/network/hyper_opt_optuna.html#HyperOptOptuna.load_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.network.hyper_opt_optuna.HyperOptOptuna.load_from_file" title="Permalink to this definition"></a></dt>
<dd><p>Load a hyperparameter optimizer from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="mala.common.parameters.html#mala.common.parameters.Parameters" title="mala.common.parameters.Parameters"><em>mala.common.parameters.Parameters</em></a>) – Parameters object with which the hyperparameter optimizer
should be created Has to be compatible with data.</p></li>
<li><p><strong>file_path</strong> (<em>string</em>) – Path to the file from which the hyperparameter optimizer should
be loaded.</p></li>
<li><p><strong>data</strong> (<a class="reference internal" href="mala.datahandling.data_handler.html#mala.datahandling.data_handler.DataHandler" title="mala.datahandling.data_handler.DataHandler"><em>mala.datahandling.data_handler.DataHandler</em></a>) – DataHandler holding the training data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>loaded_trainer</strong> – The hyperparameter optimizer that was loaded from the file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="mala.network.network.html#mala.network.network.Network" title="mala.network.network.Network">Network</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mala.network.hyper_opt_optuna.HyperOptOptuna.perform_study">
<span class="sig-name descname"><span class="pre">perform_study</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/network/hyper_opt_optuna.html#HyperOptOptuna.perform_study"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.network.hyper_opt_optuna.HyperOptOptuna.perform_study" title="Permalink to this definition"></a></dt>
<dd><p>Perform the study, i.e. the optimization.</p>
<p>This is done by sampling a certain subset of network architectures.
In this case, optuna is used.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mala.network.hyper_opt_optuna.HyperOptOptuna.requeue_zombie_trials">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">requeue_zombie_trials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">study_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdb_storage</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/network/hyper_opt_optuna.html#HyperOptOptuna.requeue_zombie_trials"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.network.hyper_opt_optuna.HyperOptOptuna.requeue_zombie_trials" title="Permalink to this definition"></a></dt>
<dd><p>Put zombie trials back into the queue to be investigated.</p>
<p>When using Optuna with scheduling systems in HPC infrastructure,
zombie trials can occur. These are trials that are still marked
as “RUNNING”, but are, in actuality, dead, since the HPC job ended.
This function takes a saved hyperparameter study, and puts all
“RUNNING” trials als “WAITING”. Upon the next execution from
checkpoint, they will be executed.</p>
<p>BE CAREFUL! DO NOT USE APPLY THIS TO A RUNNING STUDY, IT WILL MESS THE
STUDY UP! ONLY USE THIS ONCE ALL JOBS HAVE FINISHED, TO CLEAN UP,
AND THEN RESUBMIT!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rdb_storage</strong> (<em>string</em>) – Adress of the RDB storage to be cleaned.</p></li>
<li><p><strong>study_name</strong> (<em>string</em>) – Name of the study in the storage. Same as the checkpoint name.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mala.network.hyper_opt_optuna.HyperOptOptuna.resume_checkpoint">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">resume_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alternative_storage_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_pkl_checkpoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/network/hyper_opt_optuna.html#HyperOptOptuna.resume_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.network.hyper_opt_optuna.HyperOptOptuna.resume_checkpoint" title="Permalink to this definition"></a></dt>
<dd><p>Prepare resumption of hyperparameter optimization from a checkpoint.</p>
<p>Please note that to actually resume the optimization,
HyperOptOptuna.perform_study() still has to be called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>checkpoint_name</strong> (<em>string</em>) – Name of the checkpoint from which the checkpoint is loaded.</p></li>
<li><p><strong>alternative_storage_path</strong> (<em>string</em>) – Alternative storage string to load the study from.
For applications on an HPC cluster it might be necessary to
slightly modify the storage path between runs, since the SQL
server might be running on different nodes each time.</p></li>
<li><p><strong>no_data</strong> (<em>bool</em>) – If True, the data won’t actually be loaded into RAM or scaled.
This can be useful for cases where a checkpoint is loaded
for analysis purposes.</p></li>
<li><p><strong>use_pkl_checkpoints</strong> (<em>bool</em>) – If true, .pkl checkpoints will be loaded.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>loaded_params</strong> (<em>mala.common.parameters.Parameters</em>) – The Parameters saved in the checkpoint.</p></li>
<li><p><strong>new_datahandler</strong> (<em>mala.datahandling.data_handler.DataHandler</em>) – The data handler reconstructed from the checkpoint.</p></li>
<li><p><strong>new_hyperopt</strong> (<em>HyperOptOptuna</em>) – The hyperparameter optimizer reconstructed from the checkpoint.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mala.network.hyper_opt_optuna.HyperOptOptuna.set_optimal_parameters">
<span class="sig-name descname"><span class="pre">set_optimal_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mala/network/hyper_opt_optuna.html#HyperOptOptuna.set_optimal_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mala.network.hyper_opt_optuna.HyperOptOptuna.set_optimal_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Set the optimal parameters found in the present study.</p>
<p>The parameters will be written to the parameter object with which the
hyperparameter optimizer was created.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mala.network.hyper_opt_oat.html" class="btn btn-neutral float-left" title="hyper_opt_oat" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mala.network.hyperparameter.html" class="btn btn-neutral float-right" title="hyperparameter" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021 National Technology &amp; Engineering Solutions of Sandia, LLC (NTESS). Under the terms of Contract DE-NA0003525 with NTESS, the U.S. Government retains certain rights in this software. Attila Cangi, J. Austin Ellis, Lenz Fiedler, Daniel Kotik, Normand Modine, Sivasankaran Rajamanickam, Steve Schmerler, Aidan Thompson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>