<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Installation of MALA &mdash; Materials Learning Algorithms (MALA)  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/mala_favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="External modules" href="external_modules.html" />
    <link rel="prev" title="Installation" href="../installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/mala_horizontal_white.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../installation.html">Installation</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Installation of MALA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#supported-os-and-python-version">Supported OS and python version</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-conda-to-manage-dependencies-recommended">Using conda to manage dependencies (Recommended)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-from-pip">Installation from pip</a></li>
<li class="toctree-l3"><a class="reference internal" href="#downloading-and-adding-example-data-recommended">Downloading and adding example data (Recommended)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-documentation-locally-optional">Build documentation locally (Optional)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="external_modules.html">External modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="on_cluster.html">Using MALA on HPC systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="tested_systems.html">Successfully tested on</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/modules.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTE.html">Contributing to MALA</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Materials Learning Algorithms (MALA)</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../installation.html">Installation</a> &raquo;</li>
      <li>Installation of MALA</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com//mala-project/mala/blob/develop/docs/source/install/README.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="installation-of-mala">
<h1>Installation of MALA<a class="headerlink" href="#installation-of-mala" title="Permalink to this headline"></a></h1>
<p>This document details the manual installation of the MALA package.</p>
<div class="section" id="supported-os-and-python-version">
<h2>Supported OS and python version<a class="headerlink" href="#supported-os-and-python-version" title="Permalink to this headline"></a></h2>
<p>MALA itself is not bound to a certain python version, as long as the package requirements for MALA can be met by the
version of your choice. MALA has been successfully tested for python 3.8.x.
MALA can be run on Linux, macOS and Windows, so as long as you have a working
python installation with the required depdencies.
A list of machines on which MALA was tested can be found in <a class="reference internal" href="tested_systems.html"><span class="doc std std-doc">Successfully tested on</span></a>.</p>
</div>
<div class="section" id="using-conda-to-manage-dependencies-recommended">
<h2>Using conda to manage dependencies (Recommended)<a class="headerlink" href="#using-conda-to-manage-dependencies-recommended" title="Permalink to this headline"></a></h2>
<p>While installing MALA from <code class="docutils literal notranslate"><span class="pre">pip</span></code> will install required packages, we recommend
using <a class="reference external" href="https://docs.conda.io/en/latest/miniconda.html">conda</a>  to install them
beforehand. However, using <code class="docutils literal notranslate"><span class="pre">pip</span></code> to resolve dependencies works as well
(see below).</p>
<p>We provide four different environment files, depending on the architecture and
granularity of dependencies specified (find them in the <code class="docutils literal notranslate"><span class="pre">install</span></code> folder).
We use the explicit environment files for our reproducible and tested builds. Feel free to
start off with a basic environment file specifing only the direct dependencies (these
files will likely install newer versions of (sub-)dependencies and we cannot guarantee everything to work).</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>dependency granularity:</th>
<th>basic</th>
<th>explicit</th>
</tr>
</thead>
<tbody>
<tr>
<td>CPU</td>
<td><code>mala_cpu_base_environment.yml</code></td>
<td><code>mala_cpu_environment.yml</code></td>
</tr>
<tr>
<td>GPU</td>
<td><code>mala_gpu_base_environment.yml</code></td>
<td><code>mala_gpu_environment.yml</code></td>
</tr>
</tbody>
</table>
<p>Follow the steps below to set up the necessary environment.</p>
<ol class="arabic">
<li><p>(optional) If needed, specify the python version you want to use in this
environment by replacing <code class="docutils literal notranslate"><span class="pre">3.6</span></code> with your desired version in <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">dependencies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python&gt;=yourversionhere</span>
</pre></div>
</div>
</li>
<li><p>Create an environment <code class="docutils literal notranslate"><span class="pre">mala</span></code>:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conda<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>environment.yml
</pre></div>
</div>
</li>
<li><p>Activate the new environment:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conda<span class="w"> </span>activate<span class="w"> </span>mala
</pre></div>
</div>
</li>
<li><p>You can deactivate the environment with:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conda<span class="w"> </span>deactivate
</pre></div>
</div>
</li>
<li><p>You can update your conda environment by making changes to environment.yml:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conda<span class="w"> </span>env<span class="w"> </span>update<span class="w"> </span>--name<span class="w"> </span>mala<span class="w">  </span>--file<span class="w"> </span>environment.yml
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="installation-from-pip">
<h2>Installation from pip<a class="headerlink" href="#installation-from-pip" title="Permalink to this headline"></a></h2>
<p>When installing MALA via <code class="docutils literal notranslate"><span class="pre">pip</span></code>, all necessary packages are downloaded,
if they have not already been installed with e.g. <code class="docutils literal notranslate"><span class="pre">conda</span></code>. The exception to
this is <code class="docutils literal notranslate"><span class="pre">torch</span></code>.  We don’t want <code class="docutils literal notranslate"><span class="pre">torch</span></code> to be installed automatically, as
users may have or want to work with special <code class="docutils literal notranslate"><span class="pre">torch</span></code> builds provided by their
HPC infrastructure. If you install MALA manually from scratch, make sure there
is a <code class="docutils literal notranslate"><span class="pre">torch</span></code> version available to python. For local testing, people
might want to install the CPU-only version using something like</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span><span class="nv">torch</span><span class="o">==</span><span class="m">1</span>.7.1+cpu<span class="w"> </span><span class="nv">torchvision</span><span class="o">==</span><span class="m">0</span>.8.2+cpu<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="nv">torchaudio</span><span class="o">==</span><span class="m">0</span>.7.2<span class="w"> </span>-f<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>https://download.pytorch.org/whl/torch_stable.html
</pre></div>
</div>
<p>while a plain <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">torch</span></code> will pull the much larger GPU version by
default. For other ways to install PyTorch you might also refer
to <a class="reference external" href="https://pytorch.org/">https://pytorch.org/</a>.</p>
<p>Afterwards, MALA can easily be installed via</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>~/path/to/this/git/root/directory
$<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.<span class="o">[</span>options<span class="o">]</span>
</pre></div>
</div>
<p>The following options are available:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dev</span></code>: Installs <code class="docutils literal notranslate"><span class="pre">bump2version</span></code> which is needed to correctly increment
the version and thus needed for large code development</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">opt</span></code>: Installs <code class="docutils literal notranslate"><span class="pre">oapackage</span></code> and <code class="docutils literal notranslate"><span class="pre">pqkmeans</span></code>, so that the orthogonal array
method may be used for hyperparameter optimization and clustered
training data sets are accesible, both of which may be relevant if you
plan to do large scale hyperparameter optimization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">test</span></code>: Installs <code class="docutils literal notranslate"><span class="pre">pytest</span></code> which allows users to test the code</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">doc</span></code>: Installs all dependencies for building the documentary locally</p></li>
</ul>
<p>Similar to <code class="docutils literal notranslate"><span class="pre">torch</span></code>, MALA also uses optional packages which we do not include
in our general pip setup, as their configuration and/or installation is
generally more specific to the machine you operate on. Namely, MALA can be
used with:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lammps</span></code>: Enables the calculation of descriptors, see <a class="reference internal" href="external_modules.html"><span class="doc std std-doc">the instructions on external modules</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_energy</span></code>: Enables the calculation of the total energy, see <a class="reference internal" href="external_modules.html"><span class="doc std std-doc">the instructions on external modules</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mpi4py</span></code>: Enables inference parallelization (not installed alongside other
packages as installation may be very specific to your setup)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">horovod</span></code>: Enables training parallelization (not installed alongside other
packages as installation may be very specific to your setup)</p></li>
</ul>
<p>MALA can be used without these packages, an error will only occur when attempting
perform an operation these packages are crucial for. With the exception
of <code class="docutils literal notranslate"><span class="pre">lammps</span></code> and <code class="docutils literal notranslate"><span class="pre">total_energy</span></code>, these packages can be installed using
<code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p>
</div>
<div class="section" id="downloading-and-adding-example-data-recommended">
<h2>Downloading and adding example data (Recommended)<a class="headerlink" href="#downloading-and-adding-example-data-recommended" title="Permalink to this headline"></a></h2>
<p>The examples and tests need additional data to run. The MALA team provides a
data repository, that can be obtained from
<a class="reference external" href="https://github.com/mala-project/test-data">https://github.com/mala-project/test-data</a>. Please be sure to check out the
correct tag for the data repository, since the data repository itself is
subject to ongoing development as well.</p>
<p>Download data repository and check out correct tag.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/mala-project/test-data<span class="w"> </span>~/path/to/data/repo
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>~/path/to/data/repo
$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>v1.4.0
</pre></div>
</div>
<p>Export the path to that repo by</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">MALA_DATA_REPO</span><span class="o">=</span>~/path/to/data/repo
</pre></div>
</div>
<p>This will be used by tests and examples.</p>
</div>
<div class="section" id="build-documentation-locally-optional">
<h2>Build documentation locally (Optional)<a class="headerlink" href="#build-documentation-locally-optional" title="Permalink to this headline"></a></h2>
<p>Install the prerequisites (if you haven’t already during the MALA setup).</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>docs/requirements.txt
</pre></div>
</div>
<p>Afterwards, the documentation can be built via:</p>
<ol class="arabic simple">
<li><p>Change into <code class="docutils literal notranslate"><span class="pre">docs/</span></code> folder.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">apidocs</span></code> on Linux/macOS or <code class="docutils literal notranslate"><span class="pre">.\make.bat</span> <span class="pre">apidocs</span></code> on Windows.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">html</span></code> on Linux/macOS or <code class="docutils literal notranslate"><span class="pre">.\make.bat</span> <span class="pre">html</span></code> on Windows. This creates a <code class="docutils literal notranslate"><span class="pre">_build</span></code> folder inside <code class="docutils literal notranslate"><span class="pre">docs</span></code>. You may also want to use <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">html</span> <span class="pre">SPHINXOPTS=&quot;-W&quot;</span></code> sometimes. This treats warnings as errors and stops the output at first occurence of an error (useful for debugging rST syntax).</p></li>
<li><p>Open <code class="docutils literal notranslate"><span class="pre">docs/_build/html/index.html</span></code>.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">clean</span></code> on Linux/macOS or <code class="docutils literal notranslate"><span class="pre">.\make.bat</span> <span class="pre">clean</span></code> on Windows. if required (e.g. after fixing erros) and building again</p></li>
</ol>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="external_modules.html" class="btn btn-neutral float-right" title="External modules" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021 National Technology &amp; Engineering Solutions of Sandia, LLC (NTESS). Under the terms of Contract DE-NA0003525 with NTESS, the U.S. Government retains certain rights in this software. Attila Cangi, J. Austin Ellis, Lenz Fiedler, Daniel Kotik, Normand Modine, Sivasankaran Rajamanickam, Steve Schmerler, Aidan Thompson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>